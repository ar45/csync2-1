16,17d15
< Trying to fetch a row from the database.
< Trying to fetch a row from the database.
23,24c21
< Trying to fetch a row from the database.
< DB get blob: /export/home/dennis/Projects/csync2/csync2/tests/test/local DB get blob: v2:mtime=1413417725:mode=16877:user=dennis:group=schafroth:type=dir DB get blob: 2065 DB get blob: 3424520 Match (+): /export/home/dennis/Projects/csync2/csync2/tests/test/local on /export/home/dennis/Projects/csync2/csync2/tests/test/local
---
> Match (+): /export/home/dennis/Projects/csync2/csync2/tests/test/local on /export/home/dennis/Projects/csync2/csync2/tests/test/local
26,28c23
< Trying to fetch a row from the database.
< DB get blob: /export/home/dennis/Projects/csync2/csync2/tests/test/local/A DB get blob: v2:mtime=1413417725:mode=33188:user=dennis:group=schafroth:type=reg:size=2 DB get blob: 2065 DB get blob: 1810433 Match (+): /export/home/dennis/Projects/csync2/csync2/tests/test/local on /export/home/dennis/Projects/csync2/csync2/tests/test/local/A
< Trying to fetch a row from the database.
---
> Match (+): /export/home/dennis/Projects/csync2/csync2/tests/test/local on /export/home/dennis/Projects/csync2/csync2/tests/test/local/A
32a28,29
> SQL: SELECT operation, filename, other from dirty where checktxt = 'v2:mtime=1393759166:mode=33188:user=dennis:group=schafroth:type=reg:size=2' AND device = 2065 AND inode  = 1811025 AND peername = 'peer'
> SQL Query finished.
34c31
< Marking File Dirty SQL: INSERT INTO dirty (filename, forced, myname, peername, operation, checktxt, device, inode, other) VALUES ('/export/home/dennis/Projects/csync2/csync2/tests/test/local/A', 0, 'local', 'peer', 'RM', 'v2:mtime=1413417725:mode=33188:user=dennis:group=schafroth:type=reg:size=2', 2065, 1810433, NULL)
---
> Marking File Dirty SQL: INSERT INTO dirty (filename, forced, myname, peername, operation, checktxt, device, inode, other) VALUES ('/export/home/dennis/Projects/csync2/csync2/tests/test/local/A', 0, 'local', 'peer', 'RM', 'v2:mtime=1393759166:mode=33188:user=dennis:group=schafroth:type=reg:size=2', 2065, 1811025, NULL)
35a33,35
> SQL: SELECT operation, filename, other from dirty where checktxt = 'v2:mtime=1393759166:mode=33188:user=dennis:group=schafroth:type=reg:size=2' AND device = 2065 AND inode  = 1811025 AND peername = 'other'
> mark other: Old operation: NEW '/export/home/dennis/Projects/csync2/csync2/tests/test/local/A' '(null)' mark operation NEW -> NOP other:/export/home/dennis/Projects/csync2/csync2/tests/test/local/A deleted before syncing. Removing from dirty.
> SQL Query finished.
37d36
< Marking File Dirty SQL: INSERT INTO dirty (filename, forced, myname, peername, operation, checktxt, device, inode, other) VALUES ('/export/home/dennis/Projects/csync2/csync2/tests/test/local/A', 0, 'local', 'other', 'RM', 'v2:mtime=1413417725:mode=33188:user=dennis:group=schafroth:type=reg:size=2', 2065, 1810433, NULL)
43,49c42,43
< Trying to fetch a row from the database.
< DB get blob: v2:mtime=1413417725:mode=16877:user=dennis:group=schafroth:type=dir DB get blob: v2:mtime=1413417725:mode=16877:user=dennis:group=schafroth:type=dir DB get blob: 3424520 DB get blob: 2065 DB get blob: (null) csync_cmpchecktxt A: v2:mtime=1413417728:mode=16877:user=dennis:group=schafroth:type=dir 
< csync_cmpchecktxt B: v2:mtime=1413417728:mode=16877:user=dennis:group=schafroth:type=dir 
< /export/home/dennis/Projects/csync2/csync2/tests/test/local has changed: 
<  v2:mtime=1413417728:mode=16877:user=dennis:group=schafroth:type=dir 
<  v2:mtime=1413417725:mode=16877:user=dennis:group=schafroth:type=dir
< Trying to fetch a row from the database.
---
> csync_cmpchecktxt A: v2:mode=16877:user=dennis:group=schafroth:type=dir 
> csync_cmpchecktxt B: v2:mode=16877:user=dennis:group=schafroth:type=dir 
51,60d44
< Deleting old file entry SQL: DELETE FROM file WHERE filename = '/export/home/dennis/Projects/csync2/csync2/tests/test/local'
< Adding or updating file entry SQL: INSERT INTO file (filename, checktxt, device, inode, digest, mode, size) VALUES ('/export/home/dennis/Projects/csync2/csync2/tests/test/local', 'v2:mtime=1413417728:mode=16877:user=dennis:group=schafroth:type=dir', 2065, 3424520, NULL, 16877, 4096)
< Match (+): /export/home/dennis/Projects/csync2/csync2/tests/test/local on /export/home/dennis/Projects/csync2/csync2/tests/test/local
< Match (+): /export/home/dennis/Projects/csync2/csync2/tests/test/local on /export/home/dennis/Projects/csync2/csync2/tests/test/local
< mark other operation: MOD peer:/export/home/dennis/Projects/csync2/csync2/tests/test/local '-'.
< Deleting old dirty file entries SQL: DELETE FROM dirty WHERE filename = '/export/home/dennis/Projects/csync2/csync2/tests/test/local' AND peername = 'peer'
< Marking File Dirty SQL: INSERT INTO dirty (filename, forced, myname, peername, operation, checktxt, device, inode, other) VALUES ('/export/home/dennis/Projects/csync2/csync2/tests/test/local', 0, 'local', 'peer', 'MOD', 'v2:mtime=1413417728:mode=16877:user=dennis:group=schafroth:type=dir', 2065, 3424520, NULL)
< mark other operation: MOD other:/export/home/dennis/Projects/csync2/csync2/tests/test/local '-'.
< Deleting old dirty file entries SQL: DELETE FROM dirty WHERE filename = '/export/home/dennis/Projects/csync2/csync2/tests/test/local' AND peername = 'other'
< Marking File Dirty SQL: INSERT INTO dirty (filename, forced, myname, peername, operation, checktxt, device, inode, other) VALUES ('/export/home/dennis/Projects/csync2/csync2/tests/test/local', 0, 'local', 'other', 'MOD', 'v2:mtime=1413417728:mode=16877:user=dennis:group=schafroth:type=dir', 2065, 3424520, NULL)
64d47
< Trying to fetch a row from the database.
68c51,52
< Adding or updating file entry SQL: INSERT INTO file (filename, checktxt, device, inode, digest, mode, size) VALUES ('/export/home/dennis/Projects/csync2/csync2/tests/test/local/Z', 'v2:mtime=1413417725:mode=33188:user=dennis:group=schafroth:type=reg:size=2', 2065, 1810433, '7d157d7c000ae27db146575c08ce30df893d3a64', 33188, 2)
---
> Adding or updating file entry SQL: INSERT INTO file (filename, checktxt, device, inode, digest, mode, size) VALUES ('/export/home/dennis/Projects/csync2/csync2/tests/test/local/Z', 'v2:mtime=1393759166:mode=33188:user=dennis:group=schafroth:type=reg:size=2', 2065, 1811025, '7d157d7c000ae27db146575c08ce30df893d3a64', 33188, 2)
> check_dirty (mod): before mark (all) 
71a56,58
> SQL: SELECT operation, filename, other from dirty where checktxt = 'v2:mtime=1393759166:mode=33188:user=dennis:group=schafroth:type=reg:size=2' AND device = 2065 AND inode  = 1811025 AND peername = 'peer'
> mark other: Old operation: RM '/export/home/dennis/Projects/csync2/csync2/tests/test/local/A' '(null)' mark operation RM->NEW => MOVE peer '/export/home/dennis/Projects/csync2/csync2/tests/test/local/Z' '/export/home/dennis/Projects/csync2/csync2/tests/test/local/A'.
> SQL Query finished.
73c60,61
< Marking File Dirty SQL: INSERT INTO dirty (filename, forced, myname, peername, operation, checktxt, device, inode, other) VALUES ('/export/home/dennis/Projects/csync2/csync2/tests/test/local/Z', 0, 'local', 'peer', 'NEW', 'v2:mtime=1413417725:mode=33188:user=dennis:group=schafroth:type=reg:size=2', 2065, 1810433, NULL)
---
> Deleting old dirty file entries SQL: DELETE FROM dirty WHERE filename = '/export/home/dennis/Projects/csync2/csync2/tests/test/local/A' AND peername = 'peer'
> Marking File Dirty SQL: INSERT INTO dirty (filename, forced, myname, peername, operation, checktxt, device, inode, other) VALUES ('/export/home/dennis/Projects/csync2/csync2/tests/test/local/Z', 0, 'local', 'peer', 'MV', 'v2:mtime=1393759166:mode=33188:user=dennis:group=schafroth:type=reg:size=2', 2065, 1811025, '/export/home/dennis/Projects/csync2/csync2/tests/test/local/A')
74a63,64
> SQL: SELECT operation, filename, other from dirty where checktxt = 'v2:mtime=1393759166:mode=33188:user=dennis:group=schafroth:type=reg:size=2' AND device = 2065 AND inode  = 1811025 AND peername = 'other'
> SQL Query finished.
76c66
< Marking File Dirty SQL: INSERT INTO dirty (filename, forced, myname, peername, operation, checktxt, device, inode, other) VALUES ('/export/home/dennis/Projects/csync2/csync2/tests/test/local/Z', 0, 'local', 'other', 'NEW', 'v2:mtime=1413417725:mode=33188:user=dennis:group=schafroth:type=reg:size=2', 2065, 1810433, NULL)
---
> Marking File Dirty SQL: INSERT INTO dirty (filename, forced, myname, peername, operation, checktxt, device, inode, other) VALUES ('/export/home/dennis/Projects/csync2/csync2/tests/test/local/Z', 0, 'local', 'other', 'NEW', 'v2:mtime=1393759166:mode=33188:user=dennis:group=schafroth:type=reg:size=2', 2065, 1811025, NULL)
78,86c68,69
< Trying to fetch a row from the database.
< DB get blob: other Trying to fetch a row from the database.
< DB get blob: peer Trying to fetch a row from the database.
< SQL Query finished.
< SQL: SELECT filename, operation, other, checktxt, forced  FROM dirty WHERE peername = 'peer' AND myname = 'local' ORDER by filename ASC
< Trying to fetch a row from the database.
< DB get blob: /export/home/dennis/Projects/csync2/csync2/tests/test/local DB get blob: MOD DB get blob: (null) DB get blob: v2:mtime=1413417728:mode=16877:user=dennis:group=schafroth:type=dir DB get blob: 0 Trying to fetch a row from the database.
< DB get blob: /export/home/dennis/Projects/csync2/csync2/tests/test/local/A DB get blob: RM DB get blob: (null) DB get blob: v2:mtime=1413417725:mode=33188:user=dennis:group=schafroth:type=reg:size=2 DB get blob: 0 Trying to fetch a row from the database.
< DB get blob: /export/home/dennis/Projects/csync2/csync2/tests/test/local/Z DB get blob: NEW DB get blob: (null) DB get blob: v2:mtime=1413417725:mode=33188:user=dennis:group=schafroth:type=reg:size=2 DB get blob: 0 Trying to fetch a row from the database.
---
> SQL Query finished.
> SQL: SELECT filename, operation, other, forced  FROM dirty WHERE peername = 'peer' AND myname = 'local' ORDER by filename ASC
89,90d71
< local> CONFIG 
< local> HELLO local
92,119d72
< Dirty (deleted) item /export/home/dennis/Projects/csync2/csync2/tests/test/local/A RM 0 
< SQL: SELECT filename, checktxt FROM dirty WHERE device = 2065 and inode = 1810433 and peername = 'peer' and filename != '/export/home/dennis/Projects/csync2/csync2/tests/test/local/A' 
< Trying to fetch a row from the database.
< DB get blob: /export/home/dennis/Projects/csync2/csync2/tests/test/local/Z DB get blob: v2:mtime=1413417725:mode=33188:user=dennis:group=schafroth:type=reg:size=2 Trying to fetch a row from the database.
< 1 files with same dev:inode (2065:1810433) as file: /export/home/dennis/Projects/csync2/csync2/tests/test/local/A
< SQL Query finished.
< Other file found. Posible MOVE operation: /export/home/dennis/Projects/csync2/csync2/tests/test/local/Z
< csync_cmpchecktxt A: v2:mtime=1413417725:mode=33188:user=dennis:group=schafroth:type=reg:size=2 
< csync_cmpchecktxt B: v2:mtime=1413417725:mode=33188:user=dennis:group=schafroth:type=reg:size=2 
< OPERATION: MOVE /export/home/dennis/Projects/csync2/csync2/tests/test/local/A to /export/home/dennis/Projects/csync2/csync2/tests/test/local/Z
< Move operation found: /export/home/dennis/Projects/csync2/csync2/tests/test/local/A => /export/home/dennis/Projects/csync2/csync2/tests/test/local/Z. Skipping delete.
< check: /export/home/dennis/Projects/csync2/csync2/tests/test/local 54, /export/home/dennis/Projects/csync2/csync2/tests/test/local/ 60, 54.
< Match (+): /export/home/dennis/Projects/csync2/csync2/tests/test/local on /export/home/dennis/Projects/csync2/csync2/tests/test/local
< uid dennis gid schafroth
< Updating 'peer:/export/home/dennis/Projects/csync2/csync2/tests/test/local' MOD ''
< local> SIG 9iNlOKBHPfeAtRpsCgaQqTwKuGmEVZGB4vCM2ALNvBDDKIZDnoAaK0209kviFLAV %25test%25 user/group 1000 1000 dennis schafroth 16877 1413417728 
< Flags for gencheck: 113 
< csync_cmpchecktxt A: v2:mtime=0:mode=16877:user=dennis:group=schafroth:type=dir 
< csync_cmpchecktxt B: v2:mtime=0:mode=16877:user=dennis:group=schafroth:type=dir 
< Csync2 / Librsync: csync_rs_check('/export/home/dennis/Projects/csync2/csync2/tests/test/local', 0 [non-regular file])
< Opening basis_file and sig_file..
< Tempfilename is csync2.7DJm0J
< Reading signature size from peer....
< Receiving 0 bytes ..
< File has been checked successfully (files are equal).
< ?S: peer            /export/home/dennis/Projects/csync2/csync2/tests/test/local
< check move MOD /export/home/dennis/Projects/csync2/csync2/tests/test/local (null) Remove dirty-file entry. SQL: DELETE FROM dirty WHERE filename = '/export/home/dennis/Projects/csync2/csync2/tests/test/local' AND peername = 'peer'
< Directory /export/home/dennis/Projects/csync2/csync2/tests/test
123,124d75
< local> FLUSH 9iNlOKBHPfeAtRpsCgaQqTwKuGmEVZGB4vCM2ALNvBDDKIZDnoAaK0209kviFLAV %25test%25/Z
< local> SIG 9iNlOKBHPfeAtRpsCgaQqTwKuGmEVZGB4vCM2ALNvBDDKIZDnoAaK0209kviFLAV %25test%25/Z user/group 1000 1000 dennis schafroth 33188 1413417725 
133c84
< Tempfilename is csync2.afPalu
---
> Tempfilename is csync2.t8DcCN
141d91
< check move MV /export/home/dennis/Projects/csync2/csync2/tests/test/local/Z /export/home/dennis/Projects/csync2/csync2/tests/test/local/A local> MV 9iNlOKBHPfeAtRpsCgaQqTwKuGmEVZGB4vCM2ALNvBDDKIZDnoAaK0209kviFLAV %25test%25/A %25test%25/Z
146,167d95
< Match (+): /export/home/dennis/Projects/csync2/csync2/tests/test/local on /export/home/dennis/Projects/csync2/csync2/tests/test/local/Z
< uid dennis gid schafroth
< Updating 'peer:/export/home/dennis/Projects/csync2/csync2/tests/test/local/Z' NEW ''
< local> SIG 9iNlOKBHPfeAtRpsCgaQqTwKuGmEVZGB4vCM2ALNvBDDKIZDnoAaK0209kviFLAV %25test%25/Z user/group 1000 1000 dennis schafroth 33188 1413417725 
< Flags for gencheck: 113 
< csync_cmpchecktxt A: v2:mtime=0:mode=33188:user=dennis:group=schafroth:type=reg:size=2 
< csync_cmpchecktxt B: v2:mtime=0:mode=33188:user=dennis:group=schafroth:type=reg:size=2 
< Csync2 / Librsync: csync_rs_check('/export/home/dennis/Projects/csync2/csync2/tests/test/local/Z', 1 [regular file])
< Opening basis_file and sig_file..
< Tempfilename is csync2.AT2dHe
< Running rs_sig_file() from librsync....
< Reading signature size from peer....
< Receiving 32 bytes ..
< Got 32 bytes, 0 bytes left ..
< File has been checked successfully (files are equal).
< ?S: peer            /export/home/dennis/Projects/csync2/csync2/tests/test/local/Z
< check move NEW /export/home/dennis/Projects/csync2/csync2/tests/test/local/Z (null) Remove dirty-file entry. SQL: DELETE FROM dirty WHERE filename = '/export/home/dennis/Projects/csync2/csync2/tests/test/local/Z' AND peername = 'peer'
< Directory /export/home/dennis/Projects/csync2/csync2/tests/test/local
< Match (+): /export/home/dennis/Projects/csync2/csync2/tests/test/local on /export/home/dennis/Projects/csync2/csync2/tests/test/local
< Setting directory time /export/home/dennis/Projects/csync2/csync2/tests/test/local 1413417728.
< local> SETTIME 9iNlOKBHPfeAtRpsCgaQqTwKuGmEVZGB4vCM2ALNvBDDKIZDnoAaK0209kviFLAV %25test%25 1413417728 
< Skipping directory update /export/home/dennis/Projects/csync2/csync2/tests/test on peer - not in my groups.
169,176c97,98
< Setting directory time /export/home/dennis/Projects/csync2/csync2/tests/test/local 1413417728.
< local> SETTIME 9iNlOKBHPfeAtRpsCgaQqTwKuGmEVZGB4vCM2ALNvBDDKIZDnoAaK0209kviFLAV %25test%25 1413417728 
< local> BYE
< SQL: SELECT filename, operation, other, checktxt, forced  FROM dirty WHERE peername = 'other' AND myname = 'local' ORDER by filename ASC
< Trying to fetch a row from the database.
< DB get blob: /export/home/dennis/Projects/csync2/csync2/tests/test/local DB get blob: MOD DB get blob: (null) DB get blob: v2:mtime=1413417728:mode=16877:user=dennis:group=schafroth:type=dir DB get blob: 0 Trying to fetch a row from the database.
< DB get blob: /export/home/dennis/Projects/csync2/csync2/tests/test/local/A DB get blob: RM DB get blob: (null) DB get blob: v2:mtime=1413417725:mode=33188:user=dennis:group=schafroth:type=reg:size=2 DB get blob: 0 Trying to fetch a row from the database.
< DB get blob: /export/home/dennis/Projects/csync2/csync2/tests/test/local/Z DB get blob: NEW DB get blob: (null) DB get blob: v2:mtime=1413417725:mode=33188:user=dennis:group=schafroth:type=reg:size=2 DB get blob: 0 Trying to fetch a row from the database.
---
> Setting directory time /export/home/dennis/Projects/csync2/csync2/tests/test/local 1393759170.
> SQL: SELECT filename, operation, other, forced  FROM dirty WHERE peername = 'other' AND myname = 'local' ORDER by filename ASC
183d104
< Trying to fetch a row from the database.
